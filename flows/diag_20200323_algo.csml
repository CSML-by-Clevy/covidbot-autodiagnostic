start:
	// CALCUL IMC
	do sizem = size.to_float() / 100
	do sizem2 = sizem.pow(2)
	remember imc = weight.to_float() / sizem2

	// Facteurs de gravitÃ© mineurs
	do fgmineurs = 0
	if (temp >= 39) do fgmineurs = fgmineurs + 1
	if (hasDailyNap == 1) do fgmineurs = fgmineurs + 1
	if (howgood == "Mal" || howgood == "TrÃ¨s mal") do fgmineurs = fgmineurs + 1

	// Facteurs de gravitÃ© majeurs
	do fgmajeurs = 0
	if (hasSOB == 1) do fgmajeurs = fgmajeurs + 1
	if (hasFeedStruggle == 1) do fgmajeurs = fgmajeurs + 1
	if (temp <= 35.4 && temps > 0) do fgmajeurs = fgmajeurs + 1

	do hasNoPronosticFactors = (imc <= 30 &&
		hasCARDISSUE == 0 &&
		hasDiabetes == 0 &&
		hasCancer == 0 &&
		hasBreathingIllness == 0 &&
		hasKidneyFailure == 0 &&
		hasLiverIllness == 0 &&
		isPregnant != 1 &&
		hasImuneSystemFailure != 1 &&
		hasImmunosuppresseur != 1)

//////////////////////////////////////////////////////////////
// CALCULS DES NIVEAUX DE SYMPTOMES //////////////////////////
//////////////////////////////////////////////////////////////

	// Patients avec aucun symptome
	if ((hasTemp == 0 || temp == 0 || (temp >= 35.5 && temp <= 37.7)) &&
		hasCaugh == 0 &&
		hasMusclePain == 0 &&
		hasPainfulThroat == 0 &&
		hasDiarrhea == 0 &&
		hasFatigue == 0 &&
		hasFeedStruggle == 0 &&
		hasSOB == 0 &&
		(howgood == "Bien" || howgood == "Assez bien")
	) do symptomsLevel = 0

	// Tout patient avec un seul symptoÌ‚me parmi fieÌ€vre, toux, mal de gorge, courbatures :
	if ((temp > 37.7 && hasCaugh + hasPainfulThroat + hasMusclePain == 0) ||
		(temp <= 37.7 && hasCaugh + hasPainfulThroat + hasMusclePain == 1)
	) do symptomsLevel = 1

	// Patient avec
	// - fieÌ€vre,
	// - ou toux + mal de gorge,
	// - ou toux + courbatures
	// - ou fieÌ€vre + diarrheÌe <=== This one makes no sense as a simple fiever returns true already
	if (temp > 37.7 ||
		(hasCaugh == 1 && hasPainfulThroat == 1) ||
		(hasCaugh == 1 && hasMusclePain == 1) ||
		(temp > 37.7 || hasDiarrhea == 1)
	) do symptomsLevel = 2

	// Tout patient avec fieÌ€vre et toux :
	if (temp > 37.7 && hasCaugh == 1) do symptomsLevel = 3



//////////////////////////////////////////////////////////////
// CALCULS CAS UNIQUES ///////////////////////////////////////
// SELON SYMPTOMES & FACTEURS GRAVITÃ‰ ////////////////////////
//////////////////////////////////////////////////////////////

	if (age < 15) {
		say "Prenez contact avec votre meÌdecin geÌneÌraliste au moindre doute ğŸ‘¨â€âš•ï¸ğŸ‘©â€âš•ï¸. Cette application nâ€™est pour lâ€™instant pas adapteÌe aux personnes de moins de 15 ans. En cas dâ€™urgence, **appelez le 15** ğŸ“."
		goto end
	}

	if (symptomsLevel == 0) {
		say "**Votre situation ne releÌ€ve probablement pas du Covid-19** âœ… . Nâ€™heÌsitez pas aÌ€ contacter votre meÌdecin ğŸ‘¨â€âš•ï¸ en cas de doute. Vous pouvez refaire le test en cas de nouveau symptoÌ‚me pour reÌeÌvaluer la situation ğŸ‘¨â€âš•ï¸. "
		goto final
	}

	if (symptomsLevel == 1) {
		// Au moins un facteur de graviteÌ ou un facteur pronostique :
		if (hasNoPronosticFactors == false ||
		fgmineurs > 0 ||
		fgmajeurs > 0
		) {
			say "**Votre situation ne releÌ€ve probablement pas du Covid-19** âœ…. Un avis meÌdical est recommandeÌ ğŸ‘¨â€âš•ï¸. Au moindre doute, **appelez le 15** ğŸ“."
			goto final
		} else {
			say "**Votre situation ne releÌ€ve probablement pas du Covid-19** âœ…. Consultez votre meÌdecin au moindre doute ğŸ‘¨â€âš•ï¸."
			goto final
		}
	}

	if (symptomsLevel == 3) {
		// Tout patient avec ou sans facteur pronostique avec au moins un facteur de graviteÌ majeur
		if (fgmajeurs > 0) {
			say " ğŸš¨ **Appelez le 15, car vos symptÃ´mes ou antÃ©cÃ©dents nÃ©cessitent un avis rapide**."
			say Typing(2000)
			say "Les SAMU-centres 15 disposent des derniÃ¨res procÃ©dures en vigueur dans votre zone gÃ©ographique."
			say Typing(2000)
			say " Composez le **15**. Une prise en charge adaptÃ©e Ã  votre rÃ©gion et Ã  votre Ã©tat de santÃ© vous sera proposÃ©e. Restez en ligne, le dÃ©lai d'attente peut Ãªtre exceptionnellement long."
			goto final
		}
		// Tout patient sans facteur pronostique
		if (hasNoPronosticFactors == true) {
			say "âš ï¸ **Votre Ã©tat nÃ©cessite un avis mÃ©dical**"
			say Typing(2000)
			say "**Ne vous dÃ©placez pas au cabinet**, appelez pour demander conseil avant votre venue."
			say Typing(2000)
			say "Pour rechercher un avis mÃ©dical ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸, vous pouvez aussi utiliser un **service de tÃ©lÃ©consultation**. Alternativement, nous avons essayÃ© de rÃ©unir les contacts des permanences de soins ambulatoires de votre rÃ©gion."
			say {
				"content_type": "link",
				"url": "https://maladiecoronavirus.fr/teleconsultation",
				"text":"Services de TÃ©lÃ©consultation",
				"title":"Services de TÃ©lÃ©consultation"
			}
			say {
				"content_type": "link",
				"url": "https://maladiecoronavirus.fr/permanences",
				"text":"Permanences de soins ambulatoires par rÃ©gion (PDSA)",
				"title":"Permanences de soins ambulatoires par rÃ©gion (PDSA)"
			}
			goto final
			// TODO: IL MANQUE UN ELSE ?!
		}
		// Tout patient avec un facteur pronostique ou plus
		if (hasNoPronosticFactors == false) {
			// Aucun facteur de graviteÌ
			if (fgmineurs + fgmajeurs == 0) {
				say "âš ï¸ **Votre Ã©tat nÃ©cessite un avis mÃ©dical**"
				say Typing(2000)
				say "**Ne vous dÃ©placez pas au cabinet**, appelez pour demander conseil avant votre venue."
				say Typing(2000)
				say "Pour rechercher un avis mÃ©dical ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸, vous pouvez aussi utiliser un **service de tÃ©lÃ©consultation**. Alternativement, nous avons essayÃ© de rÃ©unir les contacts des permanences de soins ambulatoires de votre rÃ©gion."
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/teleconsultation",
					"text":"Services de TÃ©lÃ©consultation",
					"title":"Services de TÃ©lÃ©consultation"
				}
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/permanences",
					"text":"Permanences de soins ambulatoires par rÃ©gion (PDSA)",
					"title":"Permanences de soins ambulatoires par rÃ©gion (PDSA)"
				}

				say Typing(2000)
				say "Appelez le 15 si une geÌ‚ne respiratoire ou des difficulteÌs importantes pour sâ€™alimenter ou boire pendant plus de 24h apparaissent."
				goto final
			}
			// Un seul facteur de graviteÌ mineur
			if (fgmineurs == 1) {
				say "âš ï¸ **Votre Ã©tat nÃ©cessite un avis mÃ©dical**"
				say Typing(2000)
				say "**Ne vous dÃ©placez pas au cabinet**, appelez pour demander conseil avant votre venue."
				say Typing(2000)
				say "Pour rechercher un avis mÃ©dical ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸, vous pouvez aussi utiliser un **service de tÃ©lÃ©consultation**. Alternativement, nous avons essayÃ© de rÃ©unir les contacts des permanences de soins ambulatoires de votre rÃ©gion."
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/teleconsultation",
					"text":"Services de TÃ©lÃ©consultation",
					"title":"Services de TÃ©lÃ©consultation"
				}
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/permanences",
					"text":"Permanences de soins ambulatoires par rÃ©gion (PDSA)",
					"title":"Permanences de soins ambulatoires par rÃ©gion (PDSA)"
				}
				say Typing(2000)
				say "Appelez le **15** si une geÌ‚ne respiratoire ou des difficulteÌs importantes pour sâ€™alimenter ou boire pendant plus de 24h apparaissent."
				goto final
			}
			// Au moins deux facteurs de graviteÌ mineurs
			if (fgmineurs >= 2) {
				say " ğŸš¨ **Appelez le 15, car vos symptÃ´mes ou antÃ©cÃ©dents nÃ©cessitent un avis rapide**."
				say Typing(2000)
				say "Les SAMU-centres 15 disposent des derniÃ¨res procÃ©dures en vigueur dans votre zone gÃ©ographique."
				say Typing(2000)
				say " **Composez le 15**. Une prise en charge adaptÃ©e Ã  votre rÃ©gion et Ã  votre Ã©tat de santÃ© vous sera proposÃ©e. Restez en ligne, le dÃ©lai d'attente peut Ãªtre exceptionnellement long."
				goto final
			}
		}
	}

		if (symptomsLevel == 2) {
		// Tout patient avec ou sans facteur pronostique avec au moins un facteur de graviteÌ majeur
		if (fgmajeurs > 0) {
			say " ğŸš¨ **Appelez le 15, car vos symptÃ´mes ou antÃ©cÃ©dents nÃ©cessitent un avis rapide**."
			say Typing(2000)
			say "Les SAMU-centres 15 disposent des derniÃ¨res procÃ©dures en vigueur dans votre zone gÃ©ographique."
			say Typing(2000)
			say " **Composez le 15**. Une prise en charge adaptÃ©e Ã  votre rÃ©gion et Ã  votre Ã©tat de santÃ© vous sera proposÃ©e. Restez en ligne, le dÃ©lai d'attente peut Ãªtre exceptionnellement long."
			say Typing(2000)
			goto final
		}
		// Tout patient sans facteur pronostique
		if (hasNoPronosticFactors == true) {
			// Sans facteur de graviteÌ & <50 ans
			if (age < 50 && fgmajeurs + fgmineurs == 0) {
				say "Nous vous conseillons de **rester aÌ€ votre domicile** et de **contacter votre meÌdecin en cas dâ€™apparition de nouveaux symptoÌ‚mes** ğŸ‘¨â€âš•ï¸."
				say Typing(2000)
				say "Vous pourrez aussi utiliser aÌ€ nouveau lâ€™application ğŸ¤– pour reÌeÌvaluer vos symptoÌ‚mes ğŸŒ¡."
				goto final
			}
			// Sans facteur de graviteÌ & 50-69 ans, ou avec au moins un facteur de graviteÌ mineur
			if ((age >= 50 && age < 69 && fgmajeurs == 0 && fgmineurs == 0) || fgmineurs >= 1) {
				say "âš ï¸ **Votre Ã©tat nÃ©cessite un avis mÃ©dical**"
				say Typing(2000)
				say "**Ne vous dÃ©placez pas au cabinet**, appelez pour demander conseil avant votre venue."
				say Typing(2000)
				say "Pour rechercher un avis mÃ©dical ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸, vous pouvez aussi utiliser un **service de tÃ©lÃ©consultation**. Alternativement, nous avons essayÃ© de rÃ©unir les contacts des permanences de soins ambulatoires de votre rÃ©gion."
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/teleconsultation",
					"text":"Services de TÃ©lÃ©consultation",
					"title":"Services de TÃ©lÃ©consultation"
				}
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/permanences",
					"text":"Permanences de soins ambulatoires par rÃ©gion (PDSA)",
					"title":"Permanences de soins ambulatoires par rÃ©gion (PDSA)"
				}
				goto final
			}
			// TODO: IL MANQUE UN ELSE ?!
		}
		// Tout patient avec un facteur pronostique ou plus
		if (hasNoPronosticFactors == false) {
			// Aucun facteur de graviteÌ
			if (fgmineurs + fgmajeurs == 0) {
				say "âš ï¸ **Votre Ã©tat nÃ©cessite un avis mÃ©dical**"
				say Typing(2000)
				say "**Ne vous dÃ©placez pas au cabinet**, appelez pour demander conseil avant votre venue."
				say Typing(2000)
				say "Pour rechercher un avis mÃ©dical ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸, vous pouvez aussi utiliser un **service de tÃ©lÃ©consultation**. Alternativement, nous avons essayÃ© de rÃ©unir les contacts des permanences de soins ambulatoires de votre rÃ©gion."
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/teleconsultation",
					"text":"Services de TÃ©lÃ©consultation",
					"title":"Services de TÃ©lÃ©consultation"
				}
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/permanences",
					"text":"Permanences de soins ambulatoires par rÃ©gion (PDSA)",
					"title":"Permanences de soins ambulatoires par rÃ©gion (PDSA)"
				}
				say Typing(2000)
				say "**Appelez le 15** si une geÌ‚ne respiratoire ou des difficulteÌs importantes pour sâ€™alimenter ou boire pendant plus de 24h apparaissent."
				goto final
			}
			// Un seul facteur de graviteÌ mineur
			if (fgmineurs == 1) {
				say "âš ï¸ **Votre Ã©tat nÃ©cessite un avis mÃ©dical**"
				say Typing(2000)
				say "**Ne vous dÃ©placez pas au cabinet**, appelez pour demander conseil avant votre venue."
				say Typing(2000)
				say "Pour rechercher un avis mÃ©dical ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸, vous pouvez aussi utiliser un **service de tÃ©lÃ©consultation**. Alternativement, nous avons essayÃ© de rÃ©unir les contacts des permanences de soins ambulatoires de votre rÃ©gion."
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/teleconsultation",
					"text":"Services de TÃ©lÃ©consultation",
					"title":"Services de TÃ©lÃ©consultation"
				}
				say {
					"content_type": "link",
					"url": "https://maladiecoronavirus.fr/permanences",
					"text":"Permanences de soins ambulatoires par rÃ©gion (PDSA)",
					"title":"Permanences de soins ambulatoires par rÃ©gion (PDSA)"
				}
				say Typing(2000)
				say "**Appelez le 15** si une geÌ‚ne respiratoire ou des difficulteÌs importantes pour sâ€™alimenter ou boire pendant plus de 24h apparaissent."
				goto final
			}
			// Au moins deux facteurs de graviteÌ mineurs
			if (fgmineurs >= 2) {
				say " ğŸš¨ **Appelez le 15, car vos symptÃ´mes ou antÃ©cÃ©dents nÃ©cessitent un avis rapide**."
				say Typing(2000)
				say "Les SAMU-centres 15 disposent des derniÃ¨res procÃ©dures en vigueur dans votre zone gÃ©ographique."
				say Typing(2000)
				say " **Composez le 15**. Une prise en charge adaptÃ©e Ã  votre rÃ©gion et Ã  votre Ã©tat de santÃ© vous sera proposÃ©e. Restez en ligne, le dÃ©lai d'attente peut Ãªtre exceptionnellement long."
				goto final
			}
		}
	}
	//Cette phrase est appelÃ©e lorsque le cas n'est pas couvert par l'algorithme
	say "Malheureusement, nous n'avons pas assez de donnÃ©e pour vous rÃ©aliser un autodiagnostic. Prenez contact avec votre meÌdecin geÌneÌraliste au moindre doute ğŸ‘¨â€âš•ï¸ğŸ‘©â€âš•ï¸. En cas dâ€™urgence, appeler le 15. ğŸ“"
	goto final

final:
	//say "Restez chez vous au maximum en attendant que les symptoÌ‚mes disparaissent. Prenez votre tempeÌrature deux fois par jour. Rappel des mesures dâ€™hygieÌ€ne."
  say Typing(2000)
  say "Pour vous protÃ©ger et protÃ©ger les autres, dans la mesure du possible, **restez chez vous** et limitez les contacts avec d'autres personnes."
  say Typing(2000)
  say {
    "content_type": "link",
    "url": "https://covid19-medicaments.com",
    "text":"Pour vÃ©rifier si un mÃ©dicament pourrait prÃ©senter un risque potentiel d'aggraver vos symptÃ´mes",
    "title":"Pour vÃ©rifier si un mÃ©dicament pourrait prÃ©senter un risque potentiel d'aggraver vos symptÃ´mes, cliquez-ici :"
  }
  say {
    "content_type": "link",
    "url": "https://www.gouvernement.fr/info-coronavirus",
    "text":"Vous avez des questions additionnelles, appelez le 0800 130 000, ou suivez l'actualitÃ© sur : ",
    "title":"Vous avez des questions additionnelles, appelez le 0800 130 000, ou suivez l'actualitÃ© sur : "
  }

				// goto end

/*
	say "Voici l'ensemble de vos rÃ©ponses :"
	say Typing(2000)
	say "hasTemp : {{hasTemp}}"
	say "temp : {{temp}}"
	say "hasCaugh : {{hasCaugh}}"
	say "hasMusclePain : {{hasMusclePain}}"
	say "hasNoTaste : {{hasNoTaste}}"
	say "hasPainfulThroat : {{hasPainfulThroat}}"
	say "hasDiarrhea : {{hasDiarrhea}}"
	say "hasFatigue : {{hasFatigue}}"
	say "hasDailyNap : {{hasDailyNap}}"
	say "hasFeedStruggle : {{hasFeedStruggle}}"
	say "hasSOB : {{hasSOB}}"
	say "howgood : {{howgood}}"
	say "othersymptoms : {{othersymptoms}}"
	say "age : {{age}}"
	say "size : {{size}}"
	say "weight : {{weight}}"
	say "IMC : {{imc}}"
	say "hasCARDISSUE : {{hasCARDISSUE}}"
	say "hasDiabetes : {{hasDiabetes}}"
	say "hasCancer : {{hasCancer}}"
	say "hasBreathingIllness : {{hasBreathingIllness}}"
	say "hasKidneyFailure : {{hasKidneyFailure}}"
	say "hasLiverIllness : {{hasLiverIllness}}"
	say "isPregnant : {{isPregnant}}"
	say "hasImuneSystemFailure : {{hasImuneSystemFailure}}"
	say "hasImmunosuppresseur : {{hasImmunosuppresseur}}"
	say "location : {{location}}"
*/

	goto end
